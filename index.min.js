var G=1,_=3,J={},q=[],T="http://www.w3.org/2000/svg",M=function(r){this.events[r.type](r)},O=r=>r==null?r:r.key,P=(r,t,f,e,p)=>{t==="key"||(t[0]==="o"&&t[1]==="n"?((r.events||(r.events={}))[t=t.slice(2)]=e)?f||r.addEventListener(t,M):r.removeEventListener(t,M):!p&&t!=="list"&&t!=="form"&&t in r?r[t]=e??"":e==null||e===!1?r.removeAttribute(t):r.setAttribute(t,e))},U=(r,t)=>{var f=r.props,e=r.type===_?document.createTextNode(r.tag):(t=t||r.tag==="svg")?document.createElementNS(T,r.tag,{is:f.is}):document.createElement(r.tag,{is:f.is});for(var p in f)P(e,p,null,f[p],t);for(var g=0;g<r.children.length;g++)e.appendChild(U(r.children[g]=B(r.children[g]),t));return r.node=e},L=(r,t,f,e,p)=>{if(f!==e)if(f!=null&&f.type===_&&e.type===_)f.tag!==e.tag&&(t.nodeValue=e.tag);else if(f==null||f.tag!==e.tag)t=r.insertBefore(U(e=B(e),p),t),f!=null&&r.removeChild(f.node);else{var g,h,s,c,o=f.props,j=e.props,n=f.children,l=e.children,i=0,a=0,A=n.length-1,x=l.length-1;p=p||e.tag==="svg";for(var u in{...o,...j})(u==="value"||u==="selected"||u==="checked"?t[u]:o[u])!==j[u]&&P(t,u,o[u],j[u],p);for(;a<=x&&i<=A&&!((s=O(n[i]))==null||s!==O(l[a]));)L(t,n[i].node,n[i++],l[a]=B(l[a++]),p);for(;a<=x&&i<=A&&!((s=O(n[A]))==null||s!==O(l[x]));)L(t,n[A].node,n[A--],l[x]=B(l[x--]),p);if(i>A)for(;a<=x;)t.insertBefore(U(l[a]=B(l[a++]),p),(h=n[i])&&h.node);else if(a>x)for(;i<=A;)t.removeChild(n[i++].node);else{for(var v={},E={},u=i;u<=A;u++)(s=n[u].key)!=null&&(v[s]=n[u]);for(;a<=x;){if(s=O(h=n[i]),c=O(l[a]=B(l[a])),E[s]||c!=null&&c===O(n[i+1])){s==null&&t.removeChild(h.node),i++;continue}c==null||f.type===G?(s==null&&(L(t,h&&h.node,h,l[a],p),a++),i++):(s===c?(L(t,h.node,h,l[a],p),E[c]=!0,i++):(g=v[c])!=null?(L(t,t.insertBefore(g.node,h&&h.node),g,l[a],p),E[c]=!0):L(t,h&&h.node,null,l[a],p),a++)}for(;i<=A;)O(h=n[i++])==null&&t.removeChild(h.node);for(var u in v)E[u]==null&&t.removeChild(v[u].node)}}return e.node=t},B=r=>r!==!0&&r!==!1&&r?r:I(""),z=r=>r.nodeType===_?I(r.nodeValue,r):y(r.nodeName.toLowerCase(),J,q.map.call(r.childNodes,z),G,r),y=(r,t,f,e,p)=>({tag:r,props:t,key:t.key,children:f,type:e,node:p}),I=(r,t)=>y(r,J,q,_,t),F=(r,t,f=q)=>y(r,t,Array.isArray(f)?f:[f]),W=(r,t)=>((r=L(r.parentNode,r,r.vdom||z(r),t)).vdom=t,r);var Y=(r,t,f)=>{t=t||(s=>s),f=f||document;let e=s=>s&&typeof s=="object"&&!(s instanceof Array),p=(s,c)=>e(s)&&e(c)?{...s,...c}:c,g=(s,c)=>typeof s=="string"&&typeof c=="string"?s+c:c,h=s=>{if(s.nodeType!=1)return()=>[t(s.textContent)];let c=s.tagName.toLowerCase(),o=Array.from(s.attributes).map(({nodeName:n,nodeValue:l})=>({key:n,value:s.getAttribute(n)})),j=Array.from((c=="template"?s.content:s).childNodes).map(n=>h(n));return(n,l,i,a)=>o.reduce((A,x)=>A.reduce((u,v)=>{let{scope:E,attributes:C}=v;var{key:m,value:b}=x;return(m.substr(0,1)==":"||m.substr(m.length-1)==":")&&(m=m.substr(0,1)==":"?m.substr(1):m.substr(0,m.length-1),b==""?b=E:E&&typeof E=="object"&&E[b]!=null?b=E[b]:b=null),m=="each"?b instanceof Array&&b.forEach(R=>{u.push({attributes:{...C},scope:p(E,R)})}):m=="with"?b!=null&&u.push({...v,scope:p(E,b)}):m=="if"||m=="not"?(m=="if"&&b||m=="not"&&!b)&&u.push(v):m=="show"||m=="hide"?((m=="hide"&&b||m=="show"&&!b)&&(C.style="display: none;"+(typeof C.style=="string"?C.style:"")),u.push({...v,attributes:C})):m=="case"?l!=null&&l==b&&u.push(v):m=="switch"?u.push({...v,word:b}):m=="bind"?(b&&typeof b=="object"&&Object.keys(b).forEach(R=>{C[R]=g(C[R],b[R])}),u.push({...v,attributes:C})):(C[m]=g(C[m],b),u.push({...v,attributes:C})),u},[]),[{scope:c=="slot"?a:n,attributes:{}}]).reduce((A,{scope:x,attributes:u,word:v})=>{let E=(c=="slot"?i:j).reduce((b,R)=>(R(x,v,i||j,a).forEach(N=>{b.push(N)}),b),[]).filter(b=>b),C=c.indexOf("-")>=0?f.getElementById(c):null;if(u.text!=null&&C==null){for(;E.length;)E.pop();E.push(t(u.text)),u={...u},delete u.text}var m=null;return c=="template"||c=="slot"?m=E:C!=null?m=h(C)(u,null,j,x):m=[r(c,u,E)],m.forEach(b=>{A.push(b)}),A},[])};return(s,c)=>{if(c){let o=s.tagName.toLowerCase(),j=Array.from(s.attributes).reduce((l,{attrName:i,attrValue:a})=>({...l,[i]:a}),{}),n=h(c);return l=>r(o,j,n(l))}else{let o=h(s);return j=>o(j)[0]}}};var S=Y(F,I),Z=(r,t)=>{let f=S(r,t);return e=>W(r,f(e))};var $=({init:r,update:t,view:f,done:e})=>{var p,g=!0;let h=c=>{g&&s(t(c,p))},s=([c,o])=>{p=c,o&&o(h),f(p,h)};return s(r),()=>{g&&(g=!1,e&&e(p))}};var D=({node:r,template:t,view:f,...e})=>{let p=Z(r,t);return $({...e,view:(g,h)=>{p(f(g,h))}})};var X=(r,t)=>{r=r||{},t=t||[];var f=null,e=null;return p=>{let g=p.split("?"),h=g.shift(),s=h.split("/").map(decodeURIComponent),c=g.join("?"),{route:o,Params:j}=Object.keys(r).reduce((n,l)=>{let i=l.split("/");if(i.length==s.length){var a=1;let A=s.reduce((x,u,v)=>(x&&(i[v].substr(0,1)==":"?x[i[v].substr(1)]=u:i[v]!==u?x=null:a++),x),{});if(A&&a>n.weight)return{route:l,Params:A,weight:a}}return n},{route:"*",Params:{},weight:0});if(typeof r[o]=="function"){let n={url:p,route:o,path:h,Params:j,query:c},l={...n,old:e};typeof f=="function"&&f(l),f=r[o](t.filter(i=>typeof i=="function").reduce((i,a)=>({...a(i)||{},...i}),l)),e=n}}};var Q=r=>({Query:(r.query||"").split("&").map(t=>t.split("=")).map(t=>({key:decodeURIComponent(t.shift()),value:decodeURIComponent(t.join("="))})).filter(({key:t})=>t!="").reduce((t,{key:f,value:e})=>(f.substr(f.length-2)=="[]"?(f=f.substr(0,f.length-2),t[f]instanceof Array||(t[f]=[]),t[f].push(e)):t[f]=e,t),{})});var k=({node:r,routes:t,plugins:f})=>{let e=r.cloneNode(!0),p=X(Object.keys(t).reduce((h,s)=>({...h,[s]:c=>D({node:r,template:e,view:o=>o,...t[s],init:(t[s].init||(({Params:o})=>[o]))(c)})}),t||{}),[Q].concat(f||[])),g=()=>{p((window.location.hash||"#/").substr(1))};window.addEventListener("hashchange",g),g()};export{D as app,k as spa};
