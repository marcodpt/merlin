var G=1,_=3,J={},q=[],S="http://www.w3.org/2000/svg",M=function(r){this.events[r.type](r)},O=r=>r==null?r:r.key,P=(r,t,f,s,p)=>{t==="key"||(t[0]==="o"&&t[1]==="n"?((r.events||(r.events={}))[t=t.slice(2)]=s)?f||r.addEventListener(t,M):r.removeEventListener(t,M):!p&&t!=="list"&&t!=="form"&&t in r?r[t]=s??"":s==null||s===!1?r.removeAttribute(t):r.setAttribute(t,s))},U=(r,t)=>{var f=r.props,s=r.type===_?document.createTextNode(r.tag):(t=t||r.tag==="svg")?document.createElementNS(S,r.tag,{is:f.is}):document.createElement(r.tag,{is:f.is});for(var p in f)P(s,p,null,f[p],t);for(var o=0;o<r.children.length;o++)s.appendChild(U(r.children[o]=B(r.children[o]),t));return r.node=s},L=(r,t,f,s,p)=>{if(f!==s)if(f!=null&&f.type===_&&s.type===_)f.tag!==s.tag&&(t.nodeValue=s.tag);else if(f==null||f.tag!==s.tag)t=r.insertBefore(U(s=B(s),p),t),f!=null&&r.removeChild(f.node);else{var o,i,e,u,v=f.props,C=s.props,h=f.children,l=s.children,n=0,a=0,A=h.length-1,x=l.length-1;p=p||s.tag==="svg";for(var c in{...v,...C})(c==="value"||c==="selected"||c==="checked"?t[c]:v[c])!==C[c]&&P(t,c,v[c],C[c],p);for(;a<=x&&n<=A&&!((e=O(h[n]))==null||e!==O(l[a]));)L(t,h[n].node,h[n++],l[a]=B(l[a++]),p);for(;a<=x&&n<=A&&!((e=O(h[A]))==null||e!==O(l[x]));)L(t,h[A].node,h[A--],l[x]=B(l[x--]),p);if(n>A)for(;a<=x;)t.insertBefore(U(l[a]=B(l[a++]),p),(i=h[n])&&i.node);else if(a>x)for(;n<=A;)t.removeChild(h[n++].node);else{for(var g={},E={},c=n;c<=A;c++)(e=h[c].key)!=null&&(g[e]=h[c]);for(;a<=x;){if(e=O(i=h[n]),u=O(l[a]=B(l[a])),E[e]||u!=null&&u===O(h[n+1])){e==null&&t.removeChild(i.node),n++;continue}u==null||f.type===G?(e==null&&(L(t,i&&i.node,i,l[a],p),a++),n++):(e===u?(L(t,i.node,i,l[a],p),E[u]=!0,n++):(o=g[u])!=null?(L(t,t.insertBefore(o.node,i&&i.node),o,l[a],p),E[u]=!0):L(t,i&&i.node,null,l[a],p),a++)}for(;n<=A;)O(i=h[n++])==null&&t.removeChild(i.node);for(var c in g)E[c]==null&&t.removeChild(g[c].node)}}return s.node=t},B=r=>r!==!0&&r!==!1&&r?r:y(""),z=r=>r.nodeType===_?y(r.nodeValue,r):D(r.nodeName.toLowerCase(),J,q.map.call(r.childNodes,z),G,r),D=(r,t,f,s,p)=>({tag:r,props:t,key:t.key,children:f,type:s,node:p}),y=(r,t)=>D(r,J,q,_,t),F=(r,t,f=q)=>D(r,t,Array.isArray(f)?f:[f]),W=(r,t)=>((r=L(r.parentNode,r,r.vdom||z(r),t)).vdom=t,r);var Y=(r,t,f)=>{t=t||(e=>e),f=f||document;let s=e=>e&&typeof e=="object"&&!(e instanceof Array),p=(e,u)=>s(e)&&s(u)?{...e,...u}:u,o=(e,u)=>typeof e=="string"&&typeof u=="string"?e+u:u,i=e=>{if(e.nodeType!=1)return()=>[t(e.textContent)];let u=e.tagName.toLowerCase(),v=Array.from(e.attributes).map(({nodeName:h,nodeValue:l})=>({key:h,value:e.getAttribute(h)})),C=Array.from((u=="template"?e.content:e).childNodes).map(h=>i(h));return(h,l,n,a)=>v.reduce((A,x)=>A.reduce((c,g)=>{let{scope:E,attributes:j}=g;var{key:m,value:b}=x;return(m.substr(0,1)==":"||m.substr(m.length-1)==":")&&(m=m.substr(0,1)==":"?m.substr(1):m.substr(0,m.length-1),b==""?b=E:E&&typeof E=="object"&&E[b]!=null?b=E[b]:b=null),m=="each"?b instanceof Array&&b.forEach(R=>{c.push({attributes:{...j},scope:p(E,R)})}):m=="with"?b!=null&&c.push({...g,scope:p(E,b)}):m=="if"||m=="not"?(m=="if"&&b||m=="not"&&!b)&&c.push(g):m=="show"||m=="hide"?((m=="hide"&&b||m=="show"&&!b)&&(j.style="display: none;"+(typeof j.style=="string"?j.style:"")),c.push({...g,attributes:j})):m=="case"?l!=null&&l==b&&c.push(g):m=="switch"?c.push({...g,word:b}):m=="bind"?(b&&typeof b=="object"&&Object.keys(b).forEach(R=>{j[R]=o(j[R],b[R])}),c.push({...g,attributes:j})):(j[m]=o(j[m],b),c.push({...g,attributes:j})),c},[]),[{scope:u=="slot"?a:h,attributes:{}}]).reduce((A,{scope:x,attributes:c,word:g})=>{let E=(u=="slot"?n:C).reduce((b,R)=>(R(x,g,n||C,a).forEach(T=>{b.push(T)}),b),[]).filter(b=>b),j=u.indexOf("-")>=0?f.getElementById(u):null;if(c.text!=null&&j==null){for(;E.length;)E.pop();E.push(t(c.text)),c={...c},delete c.text}var m=null;return u=="template"||u=="slot"?m=E:j!=null?m=i(j)(c,null,C,x):m=[r(u,c,E)],m.forEach(b=>{A.push(b)}),A},[])};return(e,u)=>{if(u){let v=e.tagName.toLowerCase(),C=Array.from(e.attributes).reduce((l,{attrName:n,attrValue:a})=>({...l,[n]:a}),{}),h=i(u);return l=>r(v,C,h(l))}else{let v=i(e);return C=>v(C)[0]}}};var k=Y(F,y),Z=(r,t)=>{let f=k(r,t);return s=>W(r,f(s))};var $=({init:r,update:t,view:f,done:s})=>{var p,o=!0;let i=u=>{o&&e(t(u,p))},e=([u,v])=>{p=u,v&&v(i),f(p,i)};return e(r),()=>{o&&(o=!1,s&&s(p))}};var I=({node:r,template:t,view:f,...s})=>{let p=Z(r,t);return $({...s,view:(o,i)=>{p(f?f(o,i):o)}})};var X=(r,t)=>{r=r||{},t=t||[];var f=null,s=null;return p=>{let o=p.split("?"),i=o.shift(),e=i.split("/").map(decodeURIComponent),u=o.join("?"),{route:v,Params:C}=Object.keys(r).reduce((h,l)=>{let n=l.split("/");if(n.length==e.length){var a=1;let A=e.reduce((x,c,g)=>(x&&(n[g].substr(0,1)==":"?x[n[g].substr(1)]=c:n[g]!==c?x=null:a++),x),{});if(A&&a>h.weight)return{route:l,Params:A,weight:a}}return h},{route:"*",Params:{},weight:0});if(typeof r[v]=="function"){let h={url:p,route:v,path:i,Params:C,query:u},l={...h,old:s};typeof f=="function"&&f(l),f=r[v](t.filter(n=>typeof n=="function").reduce((n,a)=>({...a(n)||{},...n}),l)),s=h}return f||(()=>{})}};var Q=r=>({Query:(r.query||"").split("&").map(t=>t.split("=")).map(t=>({key:decodeURIComponent(t.shift()),value:decodeURIComponent(t.join("="))})).filter(({key:t})=>t!="").reduce((t,{key:f,value:s})=>(f.substr(f.length-2)=="[]"?(f=f.substr(0,f.length-2),t[f]instanceof Array||(t[f]=[]),t[f].push(s)):t[f]=s,t),{})});var N=({node:r,routes:t,plugins:f})=>{let s=r.cloneNode(!0);var p=X(Object.keys(t).reduce((e,u)=>({...e,[u]:v=>I({template:s,...t[u],node:r,init:(t[u].init||(({Params:C})=>[C]))(v)})}),t||{}),[Q].concat(f||[])),o=()=>{};let i=()=>{typeof p=="function"&&(o=p((window.location.hash||"#/").substr(1)))};return window.addEventListener("hashchange",i),i(),()=>{p=!1,window.removeEventListener("hashchange",i),o()}};export{I as app,N as spa};
